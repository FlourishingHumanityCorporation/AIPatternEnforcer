{
  "timestamp": 1752339367634,
  "result": {
    "isValid": false,
    "violations": [
      {
        "type": "json_formatting",
        "message": "JSON file formatting is inconsistent",
        "severity": "warning"
      }
    ],
    "fixes": [
      {
        "type": "format_json",
        "content": "{\n  \"policy\": {\n    \"default-src\": [\n      \"'self'\"\n    ],\n    \"script-src\": [\n      \"'self'\",\n      \"'unsafe-inline'\",\n      \"'unsafe-eval'\",\n      \"https://www.google-analytics.com\",\n      \"https://www.googletagmanager.com\",\n      \"https://plausible.io\"\n    ],\n    \"style-src\": [\n      \"'self'\",\n      \"'unsafe-inline'\",\n      \"https://fonts.googleapis.com\"\n    ],\n    \"img-src\": [\n      \"'self'\",\n      \"data:\",\n      \"blob:\",\n      \"https:\",\n      \"https://www.google-analytics.com\",\n      \"https://www.gravatar.com\"\n    ],\n    \"font-src\": [\n      \"'self'\",\n      \"https://fonts.gstatic.com\"\n    ],\n    \"connect-src\": [\n      \"'self'\",\n      \"https://api.example.com\",\n      \"wss://api.example.com\",\n      \"https://www.google-analytics.com\",\n      \"https://vitals.vercel-insights.com\"\n    ],\n    \"media-src\": [\n      \"'self'\",\n      \"blob:\"\n    ],\n    \"object-src\": [\n      \"'none'\"\n    ],\n    \"child-src\": [\n      \"'self'\"\n    ],\n    \"frame-src\": [\n      \"'self'\",\n      \"https://www.youtube.com\",\n      \"https://player.vimeo.com\"\n    ],\n    \"frame-ancestors\": [\n      \"'none'\"\n    ],\n    \"form-action\": [\n      \"'self'\"\n    ],\n    \"base-uri\": [\n      \"'self'\"\n    ],\n    \"manifest-src\": [\n      \"'self'\"\n    ],\n    \"worker-src\": [\n      \"'self'\",\n      \"blob:\"\n    ]\n  },\n  \"environments\": {\n    \"development\": {\n      \"script-src\": [\n        \"'self'\",\n        \"'unsafe-inline'\",\n        \"'unsafe-eval'\"\n      ],\n      \"connect-src\": [\n        \"'self'\",\n        \"ws://localhost:*\",\n        \"http://localhost:*\"\n      ],\n      \"report-uri\": null\n    },\n    \"staging\": {\n      \"report-uri\": \"https://staging.example.com/api/csp-report\"\n    },\n    \"production\": {\n      \"script-src\": [\n        \"'self'\",\n        \"'strict-dynamic'\",\n        \"nonce-{NONCE}\"\n      ],\n      \"report-uri\": \"https://api.example.com/api/csp-report\",\n      \"report-to\": \"csp-endpoint\"\n    }\n  },\n  \"directives\": {\n    \"upgrade-insecure-requests\": true,\n    \"block-all-mixed-content\": true\n  },\n  \"report-only\": {\n    \"enabled\": false,\n    \"percentage\": 10,\n    \"description\": \"Use report-only mode to test policy changes\"\n  },\n  \"nonce\": {\n    \"enabled\": true,\n    \"description\": \"Generate per-request nonce for inline scripts\",\n    \"implementation\": \"crypto.randomBytes(16).toString('base64')\"\n  },\n  \"violations\": {\n    \"endpoint\": \"/api/csp-report\",\n    \"logLevel\": \"warn\",\n    \"alerts\": {\n      \"threshold\": 100,\n      \"window\": \"1h\",\n      \"channel\": \"#security-alerts\"\n    }\n  },\n  \"testing\": {\n    \"tools\": [\n      \"CSP Evaluator\",\n      \"Report URI CSP Wizard\"\n    ],\n    \"command\": \"npm run test:security:csp\"\n  }\n}",
        "description": "Format JSON with consistent 2-space indentation"
      }
    ],
    "validationTime": 0.060917019844055176
  }
}